<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rechnung {{bestellung.rechnungsnummer}} - {{shop.name}}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background: #f8f9fa;
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3a8a 100%);
            color: white;
            padding: 2rem;
        }
        .shop-info { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .shop-name { font-size: 1.8rem; font-weight: bold; }
        .shop-claim { font-size: 0.9rem; opacity: 0.9; }
        .trustpilot { 
            background: rgba(255,255,255,0.1); 
            padding: 0.5rem 1rem; 
            border-radius: 20px; 
            font-size: 0.8rem; 
            margin-top: 0.5rem;
        }
        
        /* Action Buttons */
        .action-buttons {
            background: #f1f5f9;
            padding: 1rem 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            border-bottom: 1px solid #e2e8f0;
        }
        .btn {
            padding: 0.6rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-primary:hover { background: #2563eb; }
        .btn-secondary { background: #64748b; color: white; }
        .btn-secondary:hover { background: #475569; }
        .btn-success { background: #10b981; color: white; }
        .btn-success:hover { background: #059669; }
        
        /* Order Info */
        .order-header {
            background: #fef3c7;
            padding: 1.5rem 2rem;
            border-left: 4px solid #f59e0b;
        }
        .order-number {
            font-size: 2rem;
            font-weight: bold;
            color: #92400e;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .tracking-info {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 6px;
            border: 1px solid #10b981;
        }
        
        /* Customer Info */
        .customer-section {
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        .address-block h3 {
            background: #e2e8f0;
            padding: 0.7rem 1rem;
            margin: -0.5rem -1rem 1rem -1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .address-block {
            padding: 0.5rem 1rem;
            border-left: 3px solid #3b82f6;
            background: #f8fafc;
        }
        
        /* Products */
        .products-section {
            padding: 2rem;
        }
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #3b82f6;
            color: #1e40af;
        }
        .product-item {
            display: grid;
            grid-template-columns: 60px 1fr auto auto;
            gap: 1rem;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 1rem;
            background: #fafafa;
            align-items: center;
        }
        .product-image {
            width: 60px;
            height: 60px;
            background: #e2e8f0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: #64748b;
        }
        .product-details h4 {
            font-size: 1rem;
            margin-bottom: 0.3rem;
            color: #1e40af;
        }
        .product-meta {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 0.3rem;
        }
        .product-specs {
            display: flex;
            gap: 1rem;
            font-size: 0.8rem;
            color: #6b7280;
        }
        .stock-info {
            background: #dcfce7;
            color: #166534;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
        }
        .sustainability-badge {
            background: #22c55e;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            margin-top: 0.5rem;
        }
        
        /* Summary */
        .summary-section {
            background: #f8fafc;
            padding: 2rem;
            border-top: 1px solid #e2e8f0;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 0.5rem;
            max-width: 400px;
            margin-left: auto;
        }
        .summary-row {
            display: contents;
        }
        .summary-label {
            text-align: right;
            padding: 0.3rem 1rem 0.3rem 0;
        }
        .summary-value {
            text-align: right;
            font-weight: 500;
            padding: 0.3rem 0;
        }
        .total-row .summary-label,
        .total-row .summary-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #1e40af;
            border-top: 2px solid #3b82f6;
            padding-top: 1rem;
            margin-top: 0.5rem;
        }
        
        /* Sustainability */
        .sustainability-section {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            padding: 1.5rem 2rem;
        }
        .sustainability-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .sustainability-item {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
        }
        .sustainability-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        
        /* Return Section */
        .return-section {
            background: #fef3c7;
            padding: 1.5rem 2rem;
            border-top: 1px solid #fbbf24;
        }
        .return-qr {
            width: 100px;
            height: 100px;
            background: white;
            border: 2px solid #f59e0b;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            float: right;
            margin-left: 1rem;
            font-size: 0.8rem;
            color: #92400e;
            text-align: center;
        }
        
        /* Cross-Selling */
        .cross-sell-section {
            padding: 1.5rem 2rem;
            background: #f1f5f9;
        }
        .cross-sell-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .cross-sell-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }
        .cross-sell-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1e40af;
            margin: 0.5rem 0;
        }
        .cross-sell-discount {
            background: #dc2626;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        /* Footer */
        .footer {
            background: #1f2937;
            color: #d1d5db;
            padding: 2rem;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }
        .footer-section h4 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .footer-section p,
        .footer-section a {
            font-size: 0.8rem;
            color: #d1d5db;
            text-decoration: none;
            line-height: 1.4;
        }
        .footer-section a:hover { color: white; }
        
        /* Newsletter Banner */
        .newsletter-banner {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            padding: 1rem 2rem;
            text-align: center;
        }
        .newsletter-cta {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.7rem 1.5rem;
            border-radius: 6px;
            margin-top: 1rem;
            display: inline-block;
            text-decoration: none;
            font-weight: 500;
        }
        .newsletter-cta:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container { margin: 1rem; border-radius: 0; }
            .customer-section { grid-template-columns: 1fr; gap: 1rem; }
            .product-item { 
                grid-template-columns: 1fr; 
                text-align: center;
                gap: 0.5rem;
            }
            .product-image { margin: 0 auto; }
            .shop-info { text-align: center; }
            .order-number { font-size: 1.5rem; justify-content: center; }
            .action-buttons { justify-content: center; }
            .return-qr { float: none; margin: 1rem auto 0; }
            .footer-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="shop-info">
                <div>
                    <div class="shop-name">{{shop.name}}</div>
                    <div class="shop-claim">{{shop.claim}}</div>
                    <div class="trustpilot">⭐ {{shop.trustpilot}}</div>
                </div>
                <div style="text-align: right; font-size: 0.85rem;">
                    <div>{{shop.strasse}}</div>
                    <div>{{shop.plz}} {{shop.ort}}</div>
                    <div>{{shop.telefon}}</div>
                    <div>{{shop.email}}</div>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="window.print()">
                🖨️ Drucken
            </button>
            <a href="#" class="btn btn-secondary">📄 PDF Download</a>
            <a href="{{versand.tracking_url}}" class="btn btn-success">
                📦 Sendung verfolgen
            </a>
        </div>
        
        <!-- Order Header -->
        <div class="order-header">
            <div class="order-number">
                📋 Bestellung {{bestellung.bestellnummer}}
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #92400e;">
                <strong>Rechnungsnr:</strong> {{bestellung.rechnungsnummer}} | 
                <strong>Datum:</strong> {{bestellung.rechnungsdatum}} | 
                <strong>Status:</strong> {{bestellung.zahlungsstatus}}
            </div>
            <div class="tracking-info">
                <strong>🚚 Lieferung:</strong> {{bestellung.versandart}} | 
                <strong>Tracking:</strong> {{bestellung.tracking}} | 
                <strong>Erwartet:</strong> {{bestellung.voraussichtliche_lieferung}}
            </div>
        </div>
        
        <!-- Customer Section -->
        <div class="customer-section">
            <div class="address-block">
                <h3>Rechnungsadresse</h3>
                <div>{{kunde.anrede}} {{kunde.vorname}} {{kunde.nachname}}</div>
                <div>{{kunde.rechnungsadresse.strasse}}</div>
                <div>{{kunde.rechnungsadresse.plz}} {{kunde.rechnungsadresse.ort}}</div>
                <div>{{kunde.rechnungsadresse.land}}</div>
                <div style="margin-top: 0.5rem; font-size: 0.85rem; color: #64748b;">
                    Kundennr: {{kunde.kundennummer}} | {{kunde.email}}
                </div>
            </div>
            <div class="address-block">
                <h3>Lieferadresse</h3>
                <div>{{kunde.lieferadresse.empfaenger}}</div>
                <div>{{kunde.lieferadresse.strasse}}</div>
                <div>{{kunde.lieferadresse.plz}} {{kunde.lieferadresse.ort}}</div>
                <div>{{kunde.lieferadresse.land}}</div>
            </div>
        </div>
        
        <!-- Products -->
        <div class="products-section">
            <h2 class="section-title">🛍️ Ihre Bestellung</h2>
            {{#each artikel}}
            <div class="product-item">
                <div class="product-image">{{bild}}</div>
                <div class="product-details">
                    <h4>{{bezeichnung}}</h4>
                    <div class="product-meta">
                        <strong>Art.-Nr:</strong> {{artikelnummer}} | 
                        <strong>EAN:</strong> {{ean}}
                    </div>
                    <div class="product-specs">
                        {{#if farbe}}<span>Farbe: {{farbe}}</span>{{/if}}
                        {{#if groesse}}<span>Größe: {{groesse}}</span>{{/if}}
                        {{#if herkunft}}<span>{{herkunft}}</span>{{/if}}
                    </div>
                    {{#if lagerbestand}}<div class="stock-info">{{lagerbestand}}</div>{{/if}}
                    <div class="sustainability-badge">♻️ Nachhaltig</div>
                </div>
                <div style="text-align: right; font-size: 0.9rem;">
                    <div>Menge: {{menge}}</div>
                    <div>Einzelpreis: €{{einzelpreis}}</div>
                    {{#if rabatt_betrag}}<div style="color: #dc2626;">Rabatt: -€{{rabatt_betrag}}</div>{{/if}}
                </div>
                <div style="text-align: right; font-weight: bold; font-size: 1.1rem;">
                    €{{zwischensumme}}
                </div>
            </div>
            {{/each}}
        </div>
        
        <!-- Summary -->
        <div class="summary-section">
            <h3 style="margin-bottom: 1rem;">💰 Zusammenfassung</h3>
            <div class="summary-grid">
                <div class="summary-row">
                    <div class="summary-label">Warenwert:</div>
                    <div class="summary-value">€{{zusammenfassung.warenwert}}</div>
                </div>
                {{#if zusammenfassung.rabatte_gesamt}}
                <div class="summary-row">
                    <div class="summary-label" style="color: #dc2626;">Rabatte:</div>
                    <div class="summary-value" style="color: #dc2626;">-€{{zusammenfassung.rabatte_gesamt}}</div>
                </div>
                {{/if}}
                <div class="summary-row">
                    <div class="summary-label">Zwischensumme:</div>
                    <div class="summary-value">€{{zusammenfassung.zwischensumme}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">{{versand.bezeichnung}}:</div>
                    <div class="summary-value">€{{versand.kosten}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">Netto:</div>
                    <div class="summary-value">€{{zusammenfassung.summe_netto}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">MwSt. (20%):</div>
                    <div class="summary-value">€{{zusammenfassung.ust_20_de}}</div>
                </div>
                <div class="summary-row total-row">
                    <div class="summary-label">Gesamtbetrag:</div>
                    <div class="summary-value">€{{zusammenfassung.summe_brutto}}</div>
                </div>
            </div>
            
            {{#if oss_hinweis}}
            <div style="margin-top: 1.5rem; padding: 1rem; background: #fef3c7; border-radius: 6px; font-size: 0.9rem;">
                <strong>🇪🇺 OSS-Hinweis:</strong> {{oss_hinweis.text}}<br>
                {{oss_hinweis.registrierung}}
            </div>
            {{/if}}
        </div>
        
        <!-- Sustainability -->
        <div class="sustainability-section">
            <h3>🌱 Nachhaltigkeit & Umwelt</h3>
            <div class="sustainability-grid">
                <div class="sustainability-item">
                    <div class="sustainability-icon">🌍</div>
                    <div><strong>CO₂-Fußabdruck</strong></div>
                    <div>{{sustainability.co2_footprint}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">🌳</div>
                    <div><strong>Kompensation</strong></div>
                    <div>{{sustainability.kompensation}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">📦</div>
                    <div><strong>Verpackung</strong></div>
                    <div>{{sustainability.verpackung}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">🚚</div>
                    <div><strong>Versand</strong></div>
                    <div>{{sustainability.versand}}</div>
                </div>
            </div>
        </div>
        
        <!-- Return Section -->
        <div class="return-section">
            <div class="return-qr">{{retoure.label_qr}}</div>
            <h3>↩️ Rückgabe & Retoure</h3>
            <p><strong>{{retoure.frist}}</strong> - {{retoure.hinweis}}</p>
            <p style="margin-top: 0.5rem;">
                <strong>Online-Portal:</strong> <a href="{{retoure.portal_link}}" style="color: #1e40af;">{{retoure.portal_link}}</a>
            </p>
        </div>
        
        <!-- Cross-Selling -->
        {{#if cross_selling}}
        <div class="cross-sell-section">
            <h3>💡 Das könnte Sie auch interessieren</h3>
            <div class="cross-sell-grid">
                {{#each cross_selling}}
                <div class="cross-sell-item">
                    <h4>{{bezeichnung}}</h4>
                    <div class="cross-sell-price">€{{preis}}</div>
                    <div class="cross-sell-discount">{{rabatt}}</div>
                </div>
                {{/each}}
            </div>
        </div>
        {{/if}}
        
        <!-- Newsletter Banner -->
        {{#unless kunde.newsletter}}
        <div class="newsletter-banner">
            <h3>📧 Newsletter abonnieren & 10% sparen!</h3>
            <p>{{kundenservice.newsletter_hinweis}}</p>
            <a href="#" class="newsletter-cta">Jetzt anmelden</a>
        </div>
        {{/unless}}
        
        <!-- Footer -->
        <div class="footer">
            <div class="footer-grid">
                <div class="footer-section">
                    <h4>Kontakt & Service</h4>
                    <p>📞 {{kundenservice.hotline}}</p>
                    <p>🕐 {{kundenservice.zeiten}}</p>
                    <p>💬 {{kundenservice.chat}}</p>
                    <p>✉️ {{kundenservice.email}}</p>
                </div>
                <div class="footer-section">
                    <h4>Unternehmen</h4>
                    <p>{{shop.name}}</p>
                    <p>{{shop.strasse}}</p>
                    <p>{{shop.plz}} {{shop.ort}}</p>
                    <p>UID: {{shop.uid}}</p>
                    <p>{{shop.firmenbuch}}</p>
                </div>
                <div class="footer-section">
                    <h4>Banking & Payment</h4>
                    <p>{{shop.bank}}</p>
                    <p>IBAN: {{shop.iban}}</p>
                    <p>BIC: {{shop.bic}}</p>
                    <p>OSS: {{shop.oss_nummer}}</p>
                </div>
                <div class="footer-section">
                    <h4>Qualitätssiegel</h4>
                    {{#each shop.gütesiegel}}
                    <p>✓ {{this}}</p>
                    {{/each}}
                    <p style="margin-top: 1rem;">
                        <a href="#">{{kundenservice.bewertung}}</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>