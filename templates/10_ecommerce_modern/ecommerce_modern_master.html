<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rechnung {{bestellung.rechnungsnummer}} - {{shop.name}}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, Helvetica, sans-serif; 
            line-height: 1.4; 
            color: #000; 
            background: #fff;
        }
        .container { 
            max-width: 210mm; 
            margin: 0 auto; 
            background: white; 
            padding: 0;
        }
        
        /* Header */
        .header {
            border-bottom: 2px solid #333;
            padding: 1.5rem 0 1rem 0;
            margin-bottom: 1rem;
        }
        .shop-info { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start; 
        }
        .shop-name { 
            font-size: 1.4rem; 
            font-weight: bold; 
            color: #000;
            margin-bottom: 0.3rem;
        }
        .shop-claim { 
            font-size: 0.9rem; 
            color: #666;
            font-style: italic;
        }
        .company-details {
            text-align: right;
            font-size: 0.85rem;
            line-height: 1.3;
        }
        
        /* Invoice Info */
        .invoice-header {
            margin: 1.5rem 0;
            padding: 1rem;
            border: 1px solid #ddd;
            background: #f9f9f9;
        }
        .invoice-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #000;
            margin-bottom: 0.5rem;
        }
        .invoice-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            font-size: 0.9rem;
        }
        .meta-item {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 0.2rem;
        }
        .meta-label {
            font-weight: 600;
        }
        
        /* Customer Info */
        .customer-section {
            margin: 1.5rem 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        .address-block {
            border: 1px solid #ddd;
            padding: 1rem;
        }
        .address-block h3 {
            font-size: 1rem;
            font-weight: bold;
            color: #000;
            margin-bottom: 0.8rem;
            border-bottom: 1px solid #ddd;
            padding-bottom: 0.3rem;
        }
        .address-content {
            line-height: 1.3;
            font-size: 0.9rem;
        }
        
        /* Products */
        .products-section {
            margin: 2rem 0;
        }
        .section-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #000;
        }
        .products-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #ddd;
            margin-bottom: 1rem;
        }
        .products-table th,
        .products-table td {
            border: 1px solid #ddd;
            padding: 0.7rem 0.5rem;
            text-align: left;
            vertical-align: top;
            font-size: 0.9rem;
        }
        .products-table th {
            background: #f5f5f5;
            font-weight: bold;
            color: #000;
        }
        .products-table .qty-col,
        .products-table .price-col,
        .products-table .total-col {
            text-align: right;
            width: 80px;
        }
        .products-table .article-col {
            width: 100px;
        }
        .product-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
        }
        .product-details {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.2;
        }
        
        /* Summary */
        .summary-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid #ddd;
        }
        .summary-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #000;
        }
        .summary-table {
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            border-collapse: collapse;
        }
        .summary-table td {
            padding: 0.4rem 0.8rem;
            border-bottom: 1px dotted #ccc;
        }
        .summary-label {
            text-align: right;
            font-weight: normal;
        }
        .summary-value {
            text-align: right;
            font-weight: 600;
            width: 100px;
        }
        .summary-total {
            border-top: 2px solid #000;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        /* OSS Information */
        .oss-section {
            margin: 1.5rem 0;
            padding: 1rem;
            border: 1px solid #ddd;
            background: #f9f9f9;
        }
        .oss-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #000;
        }
        .oss-content {
            font-size: 0.9rem;
            line-height: 1.3;
        }
        
        /* Shipping & Return Information */
        .shipping-return-section {
            margin: 1.5rem 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        .info-block {
            border: 1px solid #ddd;
            padding: 1rem;
        }
        .info-block h3 {
            font-size: 1rem;
            font-weight: bold;
            color: #000;
            margin-bottom: 0.8rem;
            border-bottom: 1px solid #ddd;
            padding-bottom: 0.3rem;
        }
        .info-content {
            font-size: 0.9rem;
            line-height: 1.3;
        }
        
        /* Footer */
        .footer {
            margin-top: 2rem;
            padding: 1.5rem;
            border-top: 2px solid #333;
            background: #f9f9f9;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }
        .footer-section h4 {
            color: #000;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
            font-weight: bold;
        }
        .footer-section p,
        .footer-section div {
            font-size: 0.85rem;
            color: #333;
            line-height: 1.4;
            margin: 0.2rem 0;
        }
        
        /* Print Styles */
        @media print {
            body { background: white; }
            .container { max-width: none; margin: 0; }
            .no-print { display: none; }
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .customer-section { grid-template-columns: 1fr; gap: 1rem; }
            .shipping-return-section { grid-template-columns: 1fr; gap: 1rem; }
            .shop-info { flex-direction: column; text-align: center; }
            .company-details { text-align: center; margin-top: 1rem; }
            .invoice-meta { grid-template-columns: 1fr; }
            .footer-grid { grid-template-columns: 1fr; }
            .products-table { font-size: 0.8rem; }
            .products-table .qty-col,
            .products-table .price-col,
            .products-table .total-col { width: 60px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="shop-info">
                <div>
                    <div class="shop-name">{{shop.name}}</div>
                    <div class="shop-claim">{{shop.claim}}</div>
                    <div class="trustpilot">‚≠ê {{shop.trustpilot}}</div>
                </div>
                <div style="text-align: right; font-size: 0.85rem;">
                    <div>{{shop.strasse}}</div>
                    <div>{{shop.plz}} {{shop.ort}}</div>
                    <div>{{shop.telefon}}</div>
                    <div>{{shop.email}}</div>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="window.print()">
                üñ®Ô∏è Drucken
            </button>
            <a href="#" class="btn btn-secondary">üìÑ PDF Download</a>
            <a href="{{versand.tracking_url}}" class="btn btn-success">
                üì¶ Sendung verfolgen
            </a>
        </div>
        
        <!-- Order Header -->
        <div class="order-header">
            <div class="order-number">
                üìã Bestellung {{bestellung.bestellnummer}}
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #92400e;">
                <strong>Rechnungsnr:</strong> {{bestellung.rechnungsnummer}} | 
                <strong>Datum:</strong> {{bestellung.rechnungsdatum}} | 
                <strong>Status:</strong> {{bestellung.zahlungsstatus}}
            </div>
            <div class="tracking-info">
                <strong>üöö Lieferung:</strong> {{bestellung.versandart}} | 
                <strong>Tracking:</strong> {{bestellung.tracking}} | 
                <strong>Erwartet:</strong> {{bestellung.voraussichtliche_lieferung}}
            </div>
        </div>
        
        <!-- Customer Section -->
        <div class="customer-section">
            <div class="address-block">
                <h3>Rechnungsadresse</h3>
                <div>{{kunde.anrede}} {{kunde.vorname}} {{kunde.nachname}}</div>
                <div>{{kunde.rechnungsadresse.strasse}}</div>
                <div>{{kunde.rechnungsadresse.plz}} {{kunde.rechnungsadresse.ort}}</div>
                <div>{{kunde.rechnungsadresse.land}}</div>
                <div style="margin-top: 0.5rem; font-size: 0.85rem; color: #64748b;">
                    Kundennr: {{kunde.kundennummer}} | {{kunde.email}}
                </div>
            </div>
            <div class="address-block">
                <h3>Lieferadresse</h3>
                <div>{{kunde.lieferadresse.empfaenger}}</div>
                <div>{{kunde.lieferadresse.strasse}}</div>
                <div>{{kunde.lieferadresse.plz}} {{kunde.lieferadresse.ort}}</div>
                <div>{{kunde.lieferadresse.land}}</div>
            </div>
        </div>
        
        <!-- Products -->
        <div class="products-section">
            <h2 class="section-title">üõçÔ∏è Ihre Bestellung</h2>
            {{#each artikel}}
            <div class="product-item">
                <div class="product-image">{{bild}}</div>
                <div class="product-details">
                    <h4>{{bezeichnung}}</h4>
                    <div class="product-meta">
                        <strong>Art.-Nr:</strong> {{artikelnummer}} | 
                        <strong>EAN:</strong> {{ean}}
                    </div>
                    <div class="product-specs">
                        {{#if farbe}}<span>Farbe: {{farbe}}</span>{{/if}}
                        {{#if groesse}}<span>Gr√∂√üe: {{groesse}}</span>{{/if}}
                        {{#if herkunft}}<span>{{herkunft}}</span>{{/if}}
                    </div>
                    {{#if lagerbestand}}<div class="stock-info">{{lagerbestand}}</div>{{/if}}
                    <div class="sustainability-badge">‚ôªÔ∏è Nachhaltig</div>
                </div>
                <div style="text-align: right; font-size: 0.9rem;">
                    <div>Menge: {{menge}}</div>
                    <div>Einzelpreis: ‚Ç¨{{einzelpreis}}</div>
                    {{#if rabatt_betrag}}<div style="color: #dc2626;">Rabatt: -‚Ç¨{{rabatt_betrag}}</div>{{/if}}
                </div>
                <div style="text-align: right; font-weight: bold; font-size: 1.1rem;">
                    ‚Ç¨{{zwischensumme}}
                </div>
            </div>
            {{/each}}
        </div>
        
        <!-- Summary -->
        <div class="summary-section">
            <h3 style="margin-bottom: 1rem;">üí∞ Zusammenfassung</h3>
            <div class="summary-grid">
                <div class="summary-row">
                    <div class="summary-label">Warenwert:</div>
                    <div class="summary-value">‚Ç¨{{zusammenfassung.warenwert}}</div>
                </div>
                {{#if zusammenfassung.rabatte_gesamt}}
                <div class="summary-row">
                    <div class="summary-label" style="color: #dc2626;">Rabatte:</div>
                    <div class="summary-value" style="color: #dc2626;">-‚Ç¨{{zusammenfassung.rabatte_gesamt}}</div>
                </div>
                {{/if}}
                <div class="summary-row">
                    <div class="summary-label">Zwischensumme:</div>
                    <div class="summary-value">‚Ç¨{{zusammenfassung.zwischensumme}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">{{versand.bezeichnung}}:</div>
                    <div class="summary-value">‚Ç¨{{versand.kosten}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">Netto:</div>
                    <div class="summary-value">‚Ç¨{{zusammenfassung.summe_netto}}</div>
                </div>
                <div class="summary-row">
                    <div class="summary-label">MwSt. (20%):</div>
                    <div class="summary-value">‚Ç¨{{zusammenfassung.ust_20_de}}</div>
                </div>
                <div class="summary-row total-row">
                    <div class="summary-label">Gesamtbetrag:</div>
                    <div class="summary-value">‚Ç¨{{zusammenfassung.summe_brutto}}</div>
                </div>
            </div>
            
            {{#if oss_hinweis}}
            <div style="margin-top: 1.5rem; padding: 1rem; background: #fef3c7; border-radius: 6px; font-size: 0.9rem;">
                <strong>üá™üá∫ OSS-Hinweis:</strong> {{oss_hinweis.text}}<br>
                {{oss_hinweis.registrierung}}
            </div>
            {{/if}}
        </div>
        
        <!-- Sustainability -->
        <div class="sustainability-section">
            <h3>üå± Nachhaltigkeit & Umwelt</h3>
            <div class="sustainability-grid">
                <div class="sustainability-item">
                    <div class="sustainability-icon">üåç</div>
                    <div><strong>CO‚ÇÇ-Fu√üabdruck</strong></div>
                    <div>{{sustainability.co2_footprint}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">üå≥</div>
                    <div><strong>Kompensation</strong></div>
                    <div>{{sustainability.kompensation}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">üì¶</div>
                    <div><strong>Verpackung</strong></div>
                    <div>{{sustainability.verpackung}}</div>
                </div>
                <div class="sustainability-item">
                    <div class="sustainability-icon">üöö</div>
                    <div><strong>Versand</strong></div>
                    <div>{{sustainability.versand}}</div>
                </div>
            </div>
        </div>
        
        <!-- Return Section -->
        <div class="return-section">
            <div class="return-qr">{{retoure.label_qr}}</div>
            <h3>‚Ü©Ô∏è R√ºckgabe & Retoure</h3>
            <p><strong>{{retoure.frist}}</strong> - {{retoure.hinweis}}</p>
            <p style="margin-top: 0.5rem;">
                <strong>Online-Portal:</strong> <a href="{{retoure.portal_link}}" style="color: #1e40af;">{{retoure.portal_link}}</a>
            </p>
        </div>
        
        <!-- Cross-Selling -->
        {{#if cross_selling}}
        <div class="cross-sell-section">
            <h3>üí° Das k√∂nnte Sie auch interessieren</h3>
            <div class="cross-sell-grid">
                {{#each cross_selling}}
                <div class="cross-sell-item">
                    <h4>{{bezeichnung}}</h4>
                    <div class="cross-sell-price">‚Ç¨{{preis}}</div>
                    <div class="cross-sell-discount">{{rabatt}}</div>
                </div>
                {{/each}}
            </div>
        </div>
        {{/if}}
        
        <!-- Newsletter Banner -->
        {{#unless kunde.newsletter}}
        <div class="newsletter-banner">
            <h3>üìß Newsletter abonnieren & 10% sparen!</h3>
            <p>{{kundenservice.newsletter_hinweis}}</p>
            <a href="#" class="newsletter-cta">Jetzt anmelden</a>
        </div>
        {{/unless}}
        
        <!-- Footer -->
        <div class="footer">
            <div class="footer-grid">
                <div class="footer-section">
                    <h4>Kontakt & Service</h4>
                    <p>üìû {{kundenservice.hotline}}</p>
                    <p>üïê {{kundenservice.zeiten}}</p>
                    <p>üí¨ {{kundenservice.chat}}</p>
                    <p>‚úâÔ∏è {{kundenservice.email}}</p>
                </div>
                <div class="footer-section">
                    <h4>Unternehmen</h4>
                    <p>{{shop.name}}</p>
                    <p>{{shop.strasse}}</p>
                    <p>{{shop.plz}} {{shop.ort}}</p>
                    <p>UID: {{shop.uid}}</p>
                    <p>{{shop.firmenbuch}}</p>
                </div>
                <div class="footer-section">
                    <h4>Banking & Payment</h4>
                    <p>{{shop.bank}}</p>
                    <p>IBAN: {{shop.iban}}</p>
                    <p>BIC: {{shop.bic}}</p>
                    <p>OSS: {{shop.oss_nummer}}</p>
                </div>
                <div class="footer-section">
                    <h4>Qualit√§tssiegel</h4>
                    {{#each shop.g√ºtesiegel}}
                    <p>‚úì {{this}}</p>
                    {{/each}}
                    <p style="margin-top: 1rem;">
                        <a href="#">{{kundenservice.bewertung}}</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>